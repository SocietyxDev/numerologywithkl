<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luxury Numerology Report</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #5d4e6d;
            --secondary-color: #8a6e4b;
            --accent-color: #a38f80;
            --light-color: #f8f5f2;
            --dark-color: #2a2118;
            --highlight-color: #f0e6d2;
            --gold-color: #c5a267;
            --grid-gap: 25px;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            background-color: #f9f7f3;
            color: var(--dark-color);
            line-height: 1.7;
            font-family: 'Montserrat', sans-serif;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 30px;
        }
        
        .login-container, .form-container, .chart-container {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            padding: 40px;
            margin-bottom: 40px;
            border: 1px solid #e8e2d9;
        }
        
        h1, h2 {
            font-family: 'Playfair Display', serif;
            color: var(--primary-color);
            text-align: center;
            margin-bottom: 25px;
            font-weight: 700;
            letter-spacing: 0.5px;
        }
        
        h1 {
            font-size: 2.5rem;
            border-bottom: 2px solid var(--gold-color);
            padding-bottom: 15px;
            display: inline-block;
        }
        
        h2 {
            font-size: 2rem;
            margin-top: 10px;
        }
        
        h3 {
            font-family: 'Playfair Display', serif;
            color: var(--secondary-color);
            margin: 0 0 20px 0;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--gold-color);
            font-size: 1.4rem;
            font-weight: 400;
            letter-spacing: 0.3px;
        }
        
        .form-group {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--dark-color);
            font-size: 0.95rem;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 14px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            transition: all 0.3s;
            background-color: var(--light-color);
            font-family: 'Montserrat', sans-serif;
        }
        
        input:focus, textarea:focus, select:focus {
            border-color: var(--accent-color);
            outline: none;
            box-shadow: 0 0 0 2px rgba(138, 110, 75, 0.2);
        }
        
        textarea {
            min-height: 120px;
            resize: vertical;
            line-height: 1.6;
        }
        
        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            display: block;
            width: 100%;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-family: 'Montserrat', sans-serif;
        }
        
        button:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
        }
        
        .error-message {
            color: #d33;
            margin-top: 15px;
            text-align: center;
            font-weight: 600;
            font-size: 0.9rem;
        }
        
        .chart-box {
            background-color: var(--light-color);
            border-radius: 8px;
            padding: 40px;
            margin-top: 20px;
            border: 1px solid #e8e2d9;
        }
        
        .chart-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--grid-gap);
            margin-bottom: var(--grid-gap);
        }
        
        .chart-section {
            background-color: white;
            border-radius: 6px;
            padding: 25px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.03);
            border: 1px solid #f0ebe5;
            position: relative;
        }
        
        .chart-section.highlight {
            background-color: var(--highlight-color);
            border-left: 4px solid var(--gold-color);
        }
        
        .chart-section.full-width {
            grid-column: 1 / -1;
        }
        
        .numbers-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        .number-box {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            background-color: white;
            border-radius: 6px;
            padding: 20px 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            text-align: center;
            min-height: 90px;
            transition: all 0.3s;
            border: 1px solid #e8e2d9;
        }
        
        .number-value {
            font-size: 28px;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 5px;
            font-family: 'Playfair Display', serif;
        }
        
        .number-label {
            font-size: 11px;
            color: var(--dark-color);
            opacity: 0.8;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .number-box.present {
            background-color: #f0f7f0;
            border: 1px solid #c8e0c8;
        }
        
        .number-box.missing {
            background-color: #fdf0f0;
            border: 1px solid #f0c8c8;
        }
        
        .chart-item {
            margin-bottom: 15px;
            display: flex;
            align-items: flex-start;
        }
        
        .chart-label {
            font-weight: 600;
            min-width: 180px;
            color: var(--primary-color);
            font-size: 0.95rem;
        }
        
        .chart-value {
            flex: 1;
            font-size: 0.95rem;
            line-height: 1.7;
        }
        
        .chart-value strong {
            color: var(--secondary-color);
            font-weight: 600;
        }
        
        .actions {
            display: flex;
            gap: 20px;
            margin-top: 30px;
        }
        
        .actions button {
            flex: 1;
        }
        
        .secondary-btn {
            background-color: var(--accent-color);
        }
        
        .secondary-btn:hover {
            background-color: #9a826b;
        }
        
        .hidden {
            display: none;
        }
        
        .intro-text {
            font-style: italic;
            text-align: center;
            margin-bottom: 30px;
            color: #666;
            font-size: 1.1rem;
            line-height: 1.8;
        }
        
        .footer-note {
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e8e2d9;
            font-size: 0.9rem;
            color: #666;
            text-align: center;
            line-height: 1.7;
        }
        
        .edit-icon {
            position: absolute;
            top: 15px;
            right: 15px;
            color: var(--accent-color);
            cursor: pointer;
            font-size: 18px;
            opacity: 0.7;
            transition: all 0.3s;
        }
        
        .edit-icon:hover {
            opacity: 1;
            color: var(--secondary-color);
        }
        
        .editable-title {
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 4px;
            transition: all 0.3s;
        }
        
        .editable-title:hover {
            background-color: rgba(0,0,0,0.05);
        }
        
        .title-input {
            font-family: 'Playfair Display', serif;
            font-size: 1.4rem;
            border: 1px solid var(--gold-color);
            padding: 5px 10px;
            width: 100%;
            background-color: var(--highlight-color);
        }
        
        .watermark {
            position: fixed;
            bottom: 20px;
            right: 20px;
            opacity: 0.2;
            font-size: 0.8rem;
            color: var(--dark-color);
        }
        
        @media (max-width: 900px) {
            .chart-grid {
                grid-template-columns: 1fr;
            }
            
            .numbers-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            .login-container, .form-container, .chart-container {
                padding: 30px;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            h2 {
                font-size: 1.6rem;
            }
            
            .actions {
                flex-direction: column;
                gap: 15px;
            }
            
            .chart-item {
                flex-direction: column;
            }
            
            .chart-label {
                min-width: auto;
                margin-bottom: 8px;
            }
            
            .numbers-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Login Section -->
        <div id="login-section" class="login-container">
            <h1>Numerologist Portal</h1>
            <div class="form-group">
                <label for="username">Username</label>
                <input type="text" id="username" placeholder="Enter your username">
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" placeholder="Enter your password">
            </div>
            <button id="login-btn">Login</button>
            <div id="login-error" class="error-message hidden">Invalid username or password</div>
        </div>
        
        <!-- Main App (hidden initially) -->
        <div id="app-section" class="hidden">
            <!-- Input Form -->
            <div class="form-container">
                <h2>Numerology Report Generator</h2>
                <p class="intro-text">Create a bespoke numerology report with this premium editor. All fields can be customized before generating the final report.</p>
                <form id="numerology-form">
                    <div class="form-group">
                        <label for="full-name">Client Full Name</label>
                        <input type="text" id="full-name" required>
                    </div>
                    <div class="form-group">
                        <label for="dob">Date of Birth</label>
                        <input type="date" id="dob" required>
                    </div>
                    <div class="form-group">
                        <label for="life-path">Life Path Number</label>
                        <input type="number" id="life-path" min="1" max="9" required>
                    </div>
                    <div class="form-group">
                        <label for="destiny">Destiny Number</label>
                        <input type="number" id="destiny" min="1" max="9" required>
                    </div>
                    <div class="form-group">
                        <label for="soul-urge">Soul Urge Number</label>
                        <input type="number" id="soul-urge" min="1" max="9" required>
                    </div>
                    <div class="form-group">
                        <label for="personality">Personality Number</label>
                        <input type="number" id="personality" min="1" max="9" required>
                    </div>
                    <div class="form-group">
                        <label for="lucky-numbers">Lucky Numbers</label>
                        <input type="text" id="lucky-numbers" placeholder="e.g. 3, 7, 12">
                    </div>
                    <div class="form-group">
                        <label for="kua-number">Kua Number</label>
                        <input type="number" id="kua-number" min="1" max="9">
                    </div>
                    <div class="form-group">
                        <label for="missing-numbers">Missing Numbers</label>
                        <input type="text" id="missing-numbers" placeholder="e.g. 2, 5, 8">
                    </div>
                    <div class="form-group">
                        <label for="challenges">Challenges Due to Missing Numbers</label>
                        <textarea id="challenges" placeholder="Describe any challenges..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="remedies">Remedies & Solutions</label>
                        <textarea id="remedies" placeholder="Suggest remedies..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="notes">Additional Notes</label>
                        <textarea id="notes" placeholder="Any other insights..."></textarea>
                    </div>
                    <div class="form-group">
                        <label for="report-title">Report Title</label>
                        <input type="text" id="report-title" value="Personal Numerology Report">
                    </div>
                    <button type="submit">Generate Premium Report</button>
                </form>
            </div>
            
            <!-- Chart Display -->
            <div id="chart-section" class="chart-container hidden">
                <div id="chart-box" class="chart-box">
                    <!-- Chart content will be inserted here by JavaScript -->
                </div>
                <div class="actions">
                    <button id="download-btn">Download as PDF</button>
                    <button id="new-chart-btn" class="secondary-btn">Create New Report</button>
                    <button id="edit-report-btn" class="secondary-btn">Edit Report</button>
                </div>
            </div>
        </div>
    </div>

    <div class="watermark">Luxury Numerology Report Generator</div>

    <script>
        // DOM Elements
        const loginSection = document.getElementById('login-section');
        const appSection = document.getElementById('app-section');
        const loginBtn = document.getElementById('login-btn');
        const loginError = document.getElementById('login-error');
        const numerologyForm = document.getElementById('numerology-form');
        const chartSection = document.getElementById('chart-section');
        const chartBox = document.getElementById('chart-box');
        const downloadBtn = document.getElementById('download-btn');
        const newChartBtn = document.getElementById('new-chart-btn');
        const editReportBtn = document.getElementById('edit-report-btn');
        
        // Hardcoded credentials
        const CORRECT_USERNAME = 'numerologist';
        const CORRECT_PASSWORD = '12345';
        
        // Login functionality
        loginBtn.addEventListener('click', (e) => {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (username === CORRECT_USERNAME && password === CORRECT_PASSWORD) {
                loginSection.classList.add('hidden');
                appSection.classList.remove('hidden');
                loginError.classList.add('hidden');
            } else {
                loginError.classList.remove('hidden');
            }
        });
        
        // Form submission
        numerologyForm.addEventListener('submit', (e) => {
            e.preventDefault();
            generateReport();
        });
        
        // Generate the report
        function generateReport() {
            // Get form values
            const fullName = document.getElementById('full-name').value;
            const dob = document.getElementById('dob').value;
            const lifePath = document.getElementById('life-path').value;
            const destiny = document.getElementById('destiny').value;
            const soulUrge = document.getElementById('soul-urge').value;
            const personality = document.getElementById('personality').value;
            const luckyNumbers = document.getElementById('lucky-numbers').value;
            const kuaNumber = document.getElementById('kua-number').value;
            const missingNumbers = document.getElementById('missing-numbers').value;
            const challenges = document.getElementById('challenges').value;
            const remedies = document.getElementById('remedies').value;
            const notes = document.getElementById('notes').value;
            const reportTitle = document.getElementById('report-title').value || 'Personal Numerology Report';
            
            // Format date for display
            const formattedDate = dob ? new Date(dob).toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            }) : '';
            
            // Determine present numbers
            const presentNumbers = new Set([
                lifePath, 
                destiny, 
                soulUrge, 
                personality, 
                kuaNumber,
                ...(luckyNumbers ? luckyNumbers.split(',').map(num => num.trim()) : [])
            ]);
            
            // Convert missing numbers to array
            const missingNumbersArray = missingNumbers ? 
                missingNumbers.split(',').map(num => num.trim()) : [];
            
            // Generate report HTML
            chartBox.innerHTML = `
                <h2 contenteditable="true" class="editable-title">${reportTitle}</h2>
                <div class="intro-text">
                    <p>This personalized numerology report for <strong>${fullName}</strong> reveals key insights about your life path, challenges, and opportunities based on your numbers.</p>
                </div>
                
                <div class="chart-grid">
                    <!-- Numbers Present Section -->
                    <div class="chart-section full-width">
                        <h3 contenteditable="true" class="editable-title">Numbers Present in Your Chart</h3>
                        <div class="numbers-grid">
                            ${[1,2,3,4,5,6,7,8,9].map(num => {
                                const isPresent = presentNumbers.has(num.toString());
                                const isMissing = missingNumbersArray.includes(num.toString());
                                return `
                                    <div class="number-box ${isPresent ? 'present' : ''} ${isMissing ? 'missing' : ''}">
                                        <div class="number-value">${num}</div>
                                        <div class="number-label">
                                            ${isPresent ? 'Present' : isMissing ? 'Missing' : ''}
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                    
                    <!-- Core Numbers Section -->
                    <div class="chart-section">
                        <h3 contenteditable="true" class="editable-title">Core Numbers</h3>
                        <div class="chart-item">
                            <div class="chart-label" contenteditable="true">Full Name</div>
                            <div class="chart-value">${fullName}</div>
                        </div>
                        <div class="chart-item">
                            <div class="chart-label" contenteditable="true">Date of Birth</div>
                            <div class="chart-value">${formattedDate}</div>
                        </div>
                        <div class="chart-item">
                            <div class="chart-label" contenteditable="true">Life Path</div>
                            <div class="chart-value"><strong>${lifePath}</strong> - ${getLifePathMeaning(lifePath)}</div>
                        </div>
                        <div class="chart-item">
                            <div class="chart-label" contenteditable="true">Destiny</div>
                            <div class="chart-value"><strong>${destiny}</strong> - ${getDestinyMeaning(destiny)}</div>
                        </div>
                    </div>
                    
                    <!-- Secondary Numbers Section -->
                    <div class="chart-section">
                        <h3 contenteditable="true" class="editable-title">Personality Numbers</h3>
                        <div class="chart-item">
                            <div class="chart-label" contenteditable="true">Soul Urge</div>
                            <div class="chart-value"><strong>${soulUrge}</strong> - ${getSoulUrgeMeaning(soulUrge)}</div>
                        </div>
                        <div class="chart-item">
                            <div class="chart-label" contenteditable="true">Personality</div>
                            <div class="chart-value"><strong>${personality}</strong> - ${getPersonalityMeaning(personality)}</div>
                        </div>
                        <div class="chart-item">
                            <div class="chart-label" contenteditable="true">Kua Number</div>
                            <div class="chart-value"><strong>${kuaNumber || '-'}</strong> ${kuaNumber ? getKuaDirection(kuaNumber) : ''}</div>
                        </div>
                        <div class="chart-item">
                            <div class="chart-label" contenteditable="true">Lucky Numbers</div>
                            <div class="chart-value"><strong>${luckyNumbers || '-'}</strong></div>
                        </div>
                    </div>
                    
                    ${missingNumbers ? `
                    <!-- Missing Numbers Section -->
                    <div class="chart-section highlight">
                        <h3 contenteditable="true" class="editable-title">Missing Numbers Analysis</h3>
                        <div class="chart-item">
                            <div class="chart-label" contenteditable="true">Missing Numbers</div>
                            <div class="chart-value"><strong>${missingNumbers}</strong></div>
                        </div>
                        ${challenges ? `
                        <div class="chart-item">
                            <div class="chart-label" contenteditable="true">Potential Challenges</div>
                            <div class="chart-value">${challenges}</div>
                        </div>
                        ` : ''}
                    </div>
                    
                    <!-- Remedies Section -->
                    <div class="chart-section highlight">
                        <h3 contenteditable="true" class="editable-title">Remedies & Solutions</h3>
                        ${remedies ? `
                        <div class="chart-value" contenteditable="true">${remedies}</div>
                        ` : '<div class="chart-value" contenteditable="true">No specific remedies provided</div>'}
                    </div>
                    ` : ''}
                    
                    ${notes ? `
                    <!-- Additional Notes Section -->
                    <div class="chart-section full-width">
                        <h3 contenteditable="true" class="editable-title">Additional Insights</h3>
                        <div class="chart-value" contenteditable="true">${notes}</div>
                    </div>
                    ` : ''}
                </div>
                
                <div class="footer-note">
                    <p>Report generated on ${new Date().toLocaleDateString('en-US', {
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    })}</p>
                    <p>This report is for personal guidance only. Use this information as a tool for self-discovery and positive growth.</p>
                </div>
            `;
            
            // Show the chart section
            chartSection.classList.remove('hidden');
            
            // Scroll to the chart
            chartSection.scrollIntoView({ behavior: 'smooth' });
            
            // Make all editable titles focusable
            document.querySelectorAll('.editable-title').forEach(title => {
                title.addEventListener('click', function() {
                    this.focus();
                });
            });
        }
        
        // Helper functions for number meanings
        function getLifePathMeaning(number) {
            const meanings = {
                1: "The independent leader, pioneering spirit",
                2: "The cooperative peacemaker, sensitive and intuitive",
                3: "The creative communicator, expressive and joyful",
                4: "The practical builder, organized and reliable",
                5: "The freedom-loving adventurer, adaptable and progressive",
                6: "The nurturing caregiver, responsible and protective",
                7: "The spiritual seeker, analytical and wise",
                8: "The ambitious achiever, business-minded and goal-oriented",
                9: "The humanitarian, compassionate and artistic"
            };
            return meanings[number] || "";
        }
        
        function getDestinyMeaning(number) {
            const meanings = {
                1: "To develop independence and leadership qualities",
                2: "To work with others and develop diplomacy",
                3: "To express creativity and inspire others",
                4: "To build solid foundations through hard work",
                5: "To embrace change and freedom in life",
                6: "To nurture and care for others",
                7: "To seek knowledge and spiritual understanding",
                8: "To achieve material success and personal power",
                9: "To serve humanity with compassion"
            };
            return meanings[number] || "";
        }
        
        function getSoulUrgeMeaning(number) {
            const meanings = {
                1: "Desires independence and personal achievement",
                2: "Seeks harmony, partnership and emotional security",
                3: "Craves creative expression and social interaction",
                4: "Longs for stability, order and systems",
                5: "Yearns for freedom, variety and new experiences",
                6: "Desires to nurture, teach and create harmony",
                7: "Seeks knowledge, solitude and spiritual growth",
                8: "Aspires to material success and influence",
                9: "Wants to make a difference and help others"
            };
            return meanings[number] || "";
        }
        
        function getPersonalityMeaning(number) {
            const meanings = {
                1: "Appears confident, ambitious and self-reliant",
                2: "Seems gentle, tactful and diplomatic",
                3: "Comes across as enthusiastic, charming and optimistic",
                4: "Appears practical, disciplined and trustworthy",
                5: "Seems adventurous, versatile and energetic",
                6: "Appears responsible, protective and caring",
                7: "Seems thoughtful, analytical and reserved",
                8: "Appears authoritative, goal-oriented and successful",
                9: "Seems compassionate, artistic and idealistic"
            };
            return meanings[number] || "";
        }
        
        function getKuaDirection(number) {
            if (!number) return "";
            const directions = {
                1: "(North - Water Element)",
                2: "(Southwest - Earth Element)",
                3: "(East - Wood Element)",
                4: "(Southeast - Wood Element)",
                5: "(Center - Earth Element)",
                6: "(Northwest - Metal Element)",
                7: "(West - Metal Element)",
                8: "(Northeast - Earth Element)",
                9: "(South - Fire Element)"
            };
            return directions[number] || "";
        }
        
        // Download as PDF - FIXED VERSION
        downloadBtn.addEventListener('click', () => {
            // Create a clone of the chart box to avoid modifying the original
            const element = chartBox.cloneNode(true);
            
            // Remove contenteditable attributes from the clone
            element.querySelectorAll('[contenteditable]').forEach(el => {
                el.removeAttribute('contenteditable');
            });
            
            // Add the clone to the document temporarily
            element.style.position = 'absolute';
            element.style.left = '-9999px';
            document.body.appendChild(element);
            
            // PDF options
            const opt = {
                margin: 15,
                filename: 'luxury-numerology-report.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { 
                    scale: 2,
                    logging: false,
                    useCORS: true,
                    allowTaint: true,
                    letterRendering: true
                },
                jsPDF: { 
                    unit: 'mm', 
                    format: 'a4', 
                    orientation: 'portrait',
                    hotfixes: ["px_scaling"]
                }
            };
            
            // Generate PDF
            html2pdf().set(opt).from(element).save().then(() => {
                // Remove the temporary element
                document.body.removeChild(element);
            });
        });
        
        // New chart button
        newChartBtn.addEventListener('click', () => {
            chartSection.classList.add('hidden');
            numerologyForm.reset();
            document.getElementById('full-name').focus();
        });
        
        // Edit report button
        editReportBtn.addEventListener('click', () => {
            generateReport();
        });
    </script>
</body>
</html>
